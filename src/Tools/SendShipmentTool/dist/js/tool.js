!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e){t.exports=function(t,e,n,r,i,o){var s,a=t=t||{},u=typeof t.default;"object"!==u&&"function"!==u||(s=t,a=t.default);var c,l="function"==typeof a?a.options:a;if(e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0),n&&(l.functional=!0),i&&(l._scopeId=i),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},l._ssrRegister=c):r&&(c=r),c){var f=l.functional,p=f?l.render:l.beforeCreate;f?(l._injectStyles=c,l.render=function(t,e){return c.call(e),p(t,e)}):l.beforeCreate=p?[].concat(p,c):[c]}return{esModule:s,exports:a,options:l}}},function(t,e,n){t.exports=n(17)},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=(s=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),o=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(o).concat([i]).join("\n")}var s;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var s=t[i];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(t,e,n){var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i=n(15),o={},s=r&&(document.head||document.getElementsByTagName("head")[0]),a=null,u=0,c=!1,l=function(){},f=null,p="data-vue-ssr-id",d="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t){for(var e=0;e<t.length;e++){var n=t[e],r=o[n.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](n.parts[i]);for(;i<n.parts.length;i++)r.parts.push(v(n.parts[i]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var s=[];for(i=0;i<n.parts.length;i++)s.push(v(n.parts[i]));o[n.id]={id:n.id,refs:1,parts:s}}}}function m(){var t=document.createElement("style");return t.type="text/css",s.appendChild(t),t}function v(t){var e,n,r=document.querySelector("style["+p+'~="'+t.id+'"]');if(r){if(c)return l;r.parentNode.removeChild(r)}if(d){var i=u++;r=a||(a=m()),e=_.bind(null,r,i,!1),n=_.bind(null,r,i,!0)}else r=m(),e=function(t,e){var n=e.css,r=e.media,i=e.sourceMap;r&&t.setAttribute("media",r);f.ssrId&&t.setAttribute(p,e.id);i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,r),n=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else n()}}t.exports=function(t,e,n,r){c=n,f=r||{};var s=i(t,e);return h(s),function(e){for(var n=[],r=0;r<s.length;r++){var a=s[r];(u=o[a.id]).refs--,n.push(u)}e?h(s=i(t,e)):s=[];for(r=0;r<n.length;r++){var u;if(0===(u=n[r]).refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete o[u.id]}}}};var g,y=(g=[],function(t,e){return g[t]=e,g.filter(Boolean).join("\n")});function _(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}},function(t,e,n){"use strict";e.a={props:["resourceName","resourceId","field"],provide:function(){return{resourceName:this.resourceName,resourceId:this.resourceId,field:this.field}},data:function(){return{warehouse:{},resource:{},address:{},initialLoading:!0}},methods:{fetchResource:function(){return Nova.request().get(this.fetchResourceApi).then(function(t){return t.data}).catch(function(t){var e=t.response;console.error(e)})},setAddress:function(){var t=this.resource.shipment;this.warehouse={name:"收件地址名称",attribute:"warehouse",value:t.name},this.address={name:"地址",attribute:"address",value:t.simple_address}},initItemUnit:function(){this.resource.items.forEach(function(t){_.tap(_.get(t,"units",[]),function(t){t.forEach(function(t){_.isNull(t.shipment)&&_.set(t,"shipment",{id:null,logistic_id:null,tracking_number:""})})})})}},computed:{fetchResourceApi:function(){return Nova.config["erp-prefix"]+"/"+this.resourceName+"/"+this.resourceId},toName:function(){return _.get(this.resource,"warehouse.name","")},alreadyShipped:function(){return _.get(this.field,"shipped")},shipmentApi:function(){return Nova.config["erp-prefix"]+"/"+this.resourceName+"/"+this.resourceId+"/shipment"},authorizedToUpdate:function(){return _.get(this,"field.authorizedToUpdate",!1)}}}},function(t,e,n){var r=n(0)(n(35),n(36),!1,function(t){n(33)},null,null);t.exports=r.exports},function(t,e,n){var r=n(0)(n(32),n(37),!1,function(t){n(30)},"data-v-d2f98e94",null);t.exports=r.exports},function(t,e,n){"use strict";var r=n(1),i=n.n(r);e.a={props:{logistics:{type:Array,default:function(){return[]}}},data:function(){return{logisticOptions:[]}},methods:{getLogisticsList:function(){return Nova.request().get(this.logisticsApi).then(function(t){return t.data}).catch(function(t){console.error(t.response)})},initLogistics:function(){var t,e=(t=i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.logistics.length<=0)){t.next=4;break}return t.next=3,this.getLogisticsList();case 3:this.logisticOptions=t.sent;case 4:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()},computed:{logisticsApi:function(){return Nova.config["erp-prefix"]+"/logistics"}}}},function(t,e,n){n(9),t.exports=n(44)},function(t,e,n){Nova.booting(function(t,e){t.component("send-shipment-tool",n(10)),e.addRoutes([{name:"shipment.detail",path:"/resources/:resourceName/:resourceId/shipment",component:n(26),props:function(t){return{resourceName:t.params.resourceName,resourceId:t.params.resourceId}}},{name:"shipment.update",path:"/resources/:resourceName/:resourceId/shipment/edit",component:n(39),props:function(t){return{resourceName:t.params.resourceName,resourceId:t.params.resourceId}}}])})},function(t,e,n){var r=n(0)(n(11),n(25),!1,null,null,null);t.exports=r.exports},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),i=n.n(r),o=n(20),s=n.n(o);e.default={props:["resourceName","resourceId","field","resource"],components:{InventoryIncomes:i.a,InventoryExpends:s.a}}},function(t,e,n){var r=n(0)(n(16),n(19),!1,function(t){n(13)},"data-v-1449f934",null);t.exports=r.exports},function(t,e,n){var r=n(14);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(3)("595b79ec",r,!0,{})},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,"",""])},function(t,e){t.exports=function(t,e){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],s=o[0],a={id:t+":"+i,css:o[1],media:o[2],sourceMap:o[3]};r[s]?r[s].parts.push(a):n.push(r[s]={id:s,parts:[a]})}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),o=n(4);e.default={name:"inventory-incomes",mixins:[o.a],methods:{goShipment:function(){var t=this.$route.params,e=t.resourceName,n=t.resourceId;this.alreadyShipped?this.$router.push({name:"shipment.detail",params:{resourceName:e,resourceId:n}}):this.$router.push({name:"shipment.update",params:{resourceName:e,resourceId:n}})}},computed:{btnTitle:function(){return this.alreadyShipped?"物流详情":"发货"}},created:function(){var t,e=(t=i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchResource();case 2:this.resource=t.sent,this.setAddress();case 4:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()}},function(t,e,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(18),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c="object"==typeof t,l=e.regeneratorRuntime;if(l)c&&(t.exports=l);else{(l=e.regeneratorRuntime=c?t.exports:{}).wrap=b;var f="suspendedStart",p="suspendedYield",d="executing",h="completed",m={},v={};v[s]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g($([])));y&&y!==r&&i.call(y,s)&&(v=y);var _=S.prototype=w.prototype=Object.create(v);k.prototype=_.constructor=S,S.constructor=k,S[u]=k.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(_),t},l.awrap=function(t){return{__await:t}},N(C.prototype),C.prototype[a]=function(){return this},l.AsyncIterator=C,l.async=function(t,e,n,r){var i=new C(b(t,e,n,r));return l.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},N(_),_[u]="Generator",_[s]=function(){return this},_.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=$,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return a.type="throw",a.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:$(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function b(t,e,n,r){var i=e&&e.prototype instanceof w?e:w,o=Object.create(i.prototype),s=new O(r||[]);return o._invoke=function(t,e,n){var r=f;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=E(s,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=x(t,e,n);if("normal"===u.type){if(r=n.done?h:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=h,n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function w(){}function k(){}function S(){}function N(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function C(t){var e;this._invoke=function(n,r){function o(){return new Promise(function(e,o){!function e(n,r,o,s){var a=x(t[n],t,r);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,o,s)},function(t){e("throw",t,o,s)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},s)}s(a.arg)}(n,r,e,o)})}return e=e?e.then(o,o):o()}}function E(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,E(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=x(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,m):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function $(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:R}}function R(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("panel-item",{attrs:{field:t.warehouse}}),t._v(" "),n("panel-item",{staticClass:"border-none",attrs:{field:t.address}}),t._v(" "),n("button",{staticClass:"flex-no-shrink ml-auto w-full btn btn-default btn-primary inline-flex justify-center items-center",on:{click:function(e){return e.preventDefault(),t.goShipment(e)}}},[n("svg",{staticClass:"fill-current w-4 h-4 mr-1",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"}},[n("path",{staticClass:"heroicon-ui",attrs:{d:"M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-2.3-8.7l1.3 1.29 3.3-3.3a1 1 0 0 1 1.4 1.42l-4 4a1 1 0 0 1-1.4 0l-2-2a1 1 0 0 1 1.4-1.42z"}})]),t._v(" "),n("span",[t._v(t._s(t.btnTitle))])])],1)},staticRenderFns:[]}},function(t,e,n){var r=n(0)(n(23),n(24),!1,function(t){n(21)},"data-v-32bd9dde",null);t.exports=r.exports},function(t,e,n){var r=n(22);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(3)("3446c7ca",r,!0,{})},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),o=n(4);e.default={name:"inventory-expends",mixins:[o.a],methods:{goShipment:function(){var t=this.$route.params,e=t.resourceName,n=t.resourceId;!this.authorizedToUpdate||this.alreadyShipped?this.$router.push({name:"shipment.detail",params:{resourceName:e,resourceId:n}}):this.$router.push({name:"shipment.update",params:{resourceName:e,resourceId:n}})}},created:function(){var t,e=(t=i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchResource();case 2:this.resource=t.sent,this.setAddress();case 4:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("panel-item",{attrs:{field:t.warehouse}}),t._v(" "),n("panel-item",{staticClass:"border-none",attrs:{field:t.address}}),t._v(" "),n("button",{staticClass:"flex-no-shrink ml-auto w-full btn btn-default btn-primary inline-flex justify-center items-center",on:{click:function(e){return e.preventDefault(),t.goShipment(e)}}},[n("svg",{staticClass:"fill-current w-4 h-4 mr-1",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"}},[n("path",{staticClass:"heroicon-ui",attrs:{d:"M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm-2.3-8.7l1.3 1.29 3.3-3.3a1 1 0 0 1 1.4 1.42l-4 4a1 1 0 0 1-1.4 0l-2-2a1 1 0 0 1 1.4-1.42z"}})]),t._v(" "),n("span",[t._v("查看物流")])])],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)(this.resourceName,{tag:"component",attrs:{resourceName:this.resourceName,resourceId:this.resourceId,field:this.field}})},staticRenderFns:[]}},function(t,e,n){var r=n(0)(n(29),n(38),!1,function(t){n(27)},"data-v-39f15b11",null);t.exports=r.exports},function(t,e,n){var r=n(28);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(3)("1b1b824e",r,!0,{})},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),o=n(4),s=n(6),a=n.n(s),u=n(5),c=n.n(u);e.default={name:"shipment-detail",mixins:[o.a],components:{VariantListTable:a.a,TrackNumberInput:c.a},created:function(){var t,e=(t=i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchResource();case 2:this.resource=t.sent,this.setAddress(),this.initialLoading=!1;case 5:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()}},function(t,e,n){var r=n(31);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(3)("0137f4df",r,!0,{})},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),o=n(5),s=n.n(o),a=n(7);e.default={name:"variant-list-table",mixins:[a.a],props:{items:{type:Array,default:function(){return[]}},detail:{type:Boolean,default:!1}},data:function(){return{shipments:{},multipleSelection:[],dialogVisible:!1}},watch:{allShipped:function(t){t&&this.$emit("all-shipped-change")}},methods:{unitShipment:function(t,e){var n=_.cloneDeep(t);n.units=t.units.filter(function(t){return t===e}),this.$emit("shipment",[n])},checkShipment:function(t){return new Promise(function(e,n){t.logistic_id&&t.tracking_number?e():n("信息不完整，无法填充")})},fillSub:function(t,e){var n=this;this.checkShipment(t).then(function(){e.units.forEach(function(e){_.isNull(e.shipment_track_id)&&(e.shipment=Object.assign({},e.shipment,t),Nova.$emit("track-number-item-"+e.id+"-change",t))}),n.$message({message:e.variant.variantName+" 物流信息填充完成",type:"success"})}).catch(function(t){n.$message({message:t,type:"error"})})},fill:function(t){var e=this;this.checkShipment(t).then(function(){0!==e.multipleSelection.length?e.multipleSelection.forEach(function(n){e.fillSub(t,n)}):e.$message({message:"请勾选变体",type:"error"})}).catch(function(t){e.$message({message:t,type:"error"})})},initShipments:function(){var t=this;this.shipments={},this.items.forEach(function(e){t.$set(t.shipments,e.id,{logistic_id:null,tracking_number:""})})},handleSelectionChange:function(t){this.multipleSelection=t},isSelected:function(t){return this.multipleSelection.find(function(e){return e.id===t.id})},shippedCount:function(t){return t.units.filter(function(t){return!_.isNull(t.shipment_track_id)}).length},shipmentFillCount:function(t){return t.units.filter(function(t){return!_.isEmpty(t.shipment.tracking_number)}).length},openTrackNumberDetailModal:function(){}},components:{TrackNumberInput:s.a},computed:{allShipped:function(){return _.every(this.items.reduce(function(t,e){return t.push.apply(t,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e.units)),t},[]),function(t){return!_.isNull(t.shipment_track_id)})},itemIsShipped:function(){return function(t){return _.every(t.units,function(t){return!_.isNull(t.shipment_track_id)})}}},mounted:function(){var t,e=(t=i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initLogistics();case 2:this.initShipments();case 3:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()}},function(t,e,n){var r=n(34);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(3)("a41ff2ee",r,!0,{})},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,".el-select .el-input{min-width:120px}.input-with-select .el-input-group__prepend{background-color:#fff}",""])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),o=n(7);e.default={name:"track-number-input",mixins:[o.a],props:{logistics:{type:Array,default:function(){return[]}},shipment:{type:Object,default:function(){return{id:null,logistic_id:null,tracking_number:""}}},eventKey:{type:String},disabled:{type:Boolean,default:!1}},data:function(){return{logistic_id:"",tracking_number:""}},methods:{initValue:function(t){var e=t.logistic_id,n=t.tracking_number;this.logistic_id=e,this.tracking_number=n},changeInput:function(t){this.shipment.tracking_number=t},changeSelect:function(t){console.log(t),this.shipment.logistic_id=t},getValue:function(){return this.currentShipment}},computed:{list:function(){return this.logistics||this.logisticOptions},currentShipment:function(){return{logistic_id:this.logistic_id,tracking_number:this.tracking_number}},currentLogisticName:function(){return _.get(_.find(this.list,["id",this.logistic_id]),"name","-")}},mounted:function(){var t,e=(t=i.a.mark(function t(){var e=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.initValue(this.shipment),Nova.$on(this.eventKey,function(t){e.initValue(t)});case 2:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}(),destroyed:function(){Nova.$off(this.eventKey)}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.disabled?n("div",{staticClass:"flex items-center"},[n("div",{staticClass:"w-2/5 py-3"},[n("span",{staticClass:"inline-block   py-1 text-80 text-sm"},[t._v("\n            "+t._s(t.currentLogisticName)+"\n        ")])]),t._v(" "),n("div",{staticClass:"w-3/5 py-3 px-8"},[n("span",{staticClass:"inline-block  px-3 py-1 text-80 text-sm"},[t._v(t._s(t.tracking_number))])])]):n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入物流单号"},on:{change:t.changeInput},model:{value:t.tracking_number,callback:function(e){t.tracking_number=e},expression:"tracking_number"}},[n("el-select",{attrs:{slot:"prepend",disabled:t.disabled,filterable:"",placeholder:"请选择物流公司"},on:{change:t.changeSelect},slot:"prepend",model:{value:t.logistic_id,callback:function(e){t.logistic_id=e},expression:"logistic_id"}},t._l(t.list,function(t){return n("el-option",{key:t.code,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),t._t("default",null,{slot:"append",disabled:t.disabled,shipment:t.currentShipment})],2)],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",{ref:"variantTable",staticStyle:{width:"100%"},attrs:{data:t.items,"row-key":"id"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",label:"ID",prop:"id"}}),t._v(" "),n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.detail?t._e():n("el-alert",{attrs:{title:"可以为单个SKU最小单位拆分物流",type:"info","close-text":"知道了"}}),t._v(" "),n("card",{staticClass:"overflow-hidden border border-50 mb-6 my-3"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.row.units}},[n("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),n("el-table-column",{attrs:{label:"物流单号","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){e.$index;var r=e.row;return[n("track-number-input",{attrs:{"event-key":"track-number-item-"+r.id+"-change",shipment:r.shipment,logistics:t.logisticOptions,disabled:!!r.shipment_track_id||t.detail}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"right","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(r){r.$index;var i=r.row;return[i.shipment_track_id||t.detail?n("span",[n("button",{staticClass:"appearance-none focus:outline-none cursor-pointer text-70 hover:text-primary",on:{click:function(e){return e.preventDefault(),t.openTrackNumberDetailModal(e)}}},[n("icon",{attrs:{type:"view",width:"22",height:"18","view-box":"0 0 22 16"}})],1)]):n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){t.unitShipment(e.row,i)}}},[t._v("\n                                    发货\n                                ")])]}}])})],1)],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"商品名称",prop:"variant.variantName"}}),t._v(" "),n("el-table-column",{attrs:{label:"数量","min-width":"60",prop:"pcs"}}),t._v(" "),t.detail?t._e():n("el-table-column",{attrs:{label:"已发货","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){e.$index;var n=e.row;return[t._v("\n                "+t._s(t.shippedCount(n))+"\n            ")]}}])}),t._v(" "),t.detail?t._e():n("el-table-column",{attrs:{label:"已填单号","min-width":"60"},scopedSlots:t._u([{key:"default",fn:function(e){e.$index;var n=e.row;return[t._v("\n                "+t._s(t.shipmentFillCount(n))+"\n            ")]}}])}),t._v(" "),t.detail?t._e():n("el-table-column",{attrs:{label:"一键填充","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){e.$index;var r=e.row;return[t.itemIsShipped(r)?n("span",[t._v("该项目已完成发货")]):n("track-number-input",{attrs:{logistics:t.logisticOptions},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.shipment,o=e.disabled;return[n("button",{staticClass:"appearance-none focus:outline-none cursor-pointer text-70 hover:text-primary",attrs:{disabled:o},on:{click:function(e){e.preventDefault(),t.fillSub(i,r)}}},[n("icon",{attrs:{type:"edit"}})],1)]}}]),model:{value:t.shipments[r.id],callback:function(e){t.$set(t.shipments,r.id,e)},expression:"shipments[row.id]"}})]}}])}),t._v(" "),t.detail?t._e():n("el-table-column",{attrs:{label:"操作",align:"right","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(e){e.$index;var r=e.row;return[n("el-button",{attrs:{disabled:t.itemIsShipped(r),type:"primary",size:"medium"},on:{click:function(e){t.$emit("shipment",[r])}}},[t._v("批量发货\n                ")])]}}])})],1),t._v(" "),t.detail?t._e():n("div",{staticClass:"bg-30 flex py-4 px-6"},[t.allShipped?n("span",{staticClass:"ml-auto text-80 font-normal"},[t._v("发货已完成！")]):[n("track-number-input",{staticClass:"ml-auto mr-3",staticStyle:{width:"50%"},attrs:{logistics:t.logisticOptions},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.shipment;return e.disabled,[n("button",{staticClass:"appearance-none cursor-pointer text-70 hover:text-primary",on:{click:function(e){e.preventDefault(),t.fill(r)}}},[n("icon",{attrs:{type:"edit"}})],1)]}}])}),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.$emit("shipment",t.items)}}},[t._v("批量发货")])]],2)],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("loading-view",{attrs:{loading:t.initialLoading}},[n("heading",{staticClass:"mb-3"},[t._v("Address")]),t._v(" "),n("card",{staticClass:"overflow-hidden border border-50 mb-6"},[n("div",{staticClass:"py-3 px-6"},[n("panel-item",{attrs:{field:t.warehouse}}),t._v(" "),n("panel-item",{staticClass:"border-none",attrs:{field:t.address}})],1)]),t._v(" "),n("heading",{staticClass:"mb-3"},[t._v("Send Shipment Edit")]),t._v(" "),n("card",{staticClass:"overflow-hidden border border-50 mb-6"},[n("variant-list-table",{attrs:{items:t.resource.items,detail:""},on:{shipment:t.shipment}})],1)],1)},staticRenderFns:[]}},function(t,e,n){var r=n(0)(n(42),n(43),!1,function(t){n(40)},null,null);t.exports=r.exports},function(t,e,n){var r=n(41);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n(3)("01de733d",r,!0,{})},function(t,e,n){(t.exports=n(2)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n.n(r),o=n(4),s=n(6),a=n.n(s),u=n(5),c=n.n(u);e.default={name:"shipment-update",mixins:[o.a],components:{VariantListTable:a.a,TrackNumberInput:c.a},methods:{shipment:function(t){var e=this;Nova.request().post(this.shipmentApi,this.filterItemShipped(t)).then(function(t){var n=t.data,r=n.data,i=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(n,["data"]);e.handleChange(r),e.$notify(i)})},allShippedChange:function(){this.$router.replace({name:"shipment.detail",params:{resourceName:this.resourceName,resourceId:this.resourceId}})},filterItemShipped:function(t){return t.map(function(t){var e=_.cloneDeep(t);return e.units=e.units.filter(function(t){return _.isNull(t.shipment_track_id)}),{id:e.id,inventory_income_id:e.inventory_income_id,units:e.units}})},handleChange:function(t){var e=this;t.forEach(function(t){var n=_.find(e.resource.items,["id",t.id]);n.units.forEach(function(e,r){var i=t.units.find(function(t){return t.id===e.id});i&&n.units.splice(r,1,i)})})}},created:function(){var t,e=(t=i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchResource();case 2:this.resource=t.sent,this.initItemUnit(),this.setAddress(),this.initialLoading=!1;case 6:case"end":return t.stop()}},t,this)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var s=e[i](o),a=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(a).then(function(t){r("next",t)},function(t){r("throw",t)});t(a)}("next")})});return function(){return e.apply(this,arguments)}}()}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("loading-view",{attrs:{loading:t.initialLoading}},[n("heading",{staticClass:"mb-3"},[t._v("Address")]),t._v(" "),n("card",{staticClass:"overflow-hidden border border-50 mb-6"},[n("div",{staticClass:"py-3 px-6"},[n("panel-item",{attrs:{field:t.warehouse}}),t._v(" "),n("panel-item",{staticClass:"border-none",attrs:{field:t.address}})],1)]),t._v(" "),n("heading",{staticClass:"mb-3"},[t._v("Send Shipment Edit")]),t._v(" "),n("card",{staticClass:"overflow-hidden border border-50 mb-6"},[n("variant-list-table",{attrs:{items:t.resource.items},on:{"all-shipped-change":t.allShippedChange,shipment:t.shipment}})],1)],1)},staticRenderFns:[]}},function(t,e){}]);